var doc=document,objectTag="embed",isInternetExplorer=-1!=navigator.userAgent.indexOf("MSIE"),isMozillaFirefox=-1!=navigator.userAgent.indexOf("Firefox"),isGoogleChrome=-1!=navigator.userAgent.indexOf("Chrome"),isAppleSafari=-1!=navigator.userAgent.indexOf("Safari");
function getBrowserVersion(){var j=-1,h=null;if(isInternetExplorer)h="MSIE ";if(isMozillaFirefox)h="Firefox/";if(isGoogleChrome)h="Chrome/";if(isAppleSafari)h="Version/";if(null!=h)if(null!=RegExp(h+"([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent))j=parseFloat(RegExp.$1);return j}
if(isInternetExplorer){objectTag="object";ReplaceVideoElements()}else if(isMozillaFirefox){var OnDOMContentLoadedHandled=function(){ReplaceVideoElements()},OnDOMContentLoadedTabbedHandled=function(j){doc=j.originalTarget;if(doc instanceof HTMLDocument)if(doc.defaultView.frameElement)for(;doc.defaultView.frameElement;)doc=doc.defaultView.frameElement.ownerDocument;ReplaceVideoElements()};gBrowser?gBrowser.addEventListener("DOMContentLoaded",OnDOMContentLoadedTabbedHandled,false):window.addEventListener("DOMContentLoaded",
OnDOMContentLoadedHandled,false)}else if(isGoogleChrome)ReplaceVideoElements();else if(isAppleSafari){OnDOMContentLoadedHandled=function(){ReplaceVideoElements()};window.addEventListener("DOMContentLoaded",OnDOMContentLoadedHandled,false)}function MessageHandler(){}function ElementHasAttribute(j,h){if(isInternetExplorer){h=j.getAttribute(h);return null!=h}else return j.hasAttribute(h)}
function getCSS(j,h){if(!window.getComputedStyle)window.getComputedStyle=function(l){this.el=l;this.getPropertyValue=function(i){var o=/(\-([a-z]){1})/g;if(i=="float")i="styleFloat";if(o.test(i))i=i.replace(o,function(w,x,r){return r.toUpperCase()});return l.currentStyle[i]?l.currentStyle[i]:null};return this};var p=window.getComputedStyle(j,null).getPropertyValue(h);if(null==p||""==p||"auto"==p)return 0;return parseInt(p)}
function ReplaceVideoElements(){function j(a){null!=a.target&&null!=a.target.tagName&&"video"==a.target.tagName.toLowerCase()&&l(a.target)}function h(a){null!=a.target&&null!=a.target.tagName&&"video"==a.target.tagName.toLowerCase()&&l(a.target)}function p(a,b){var c=a.substring(0,6),d=b.substring(0,6);if(c=="http:/"||c=="file:/")return true;else if(a.indexOf(":/")!=-1)return false;else if(d=="http:/"||d=="file:/")return true;return false}function l(a){var b,c="";if(ElementHasAttribute(a,"src")){if(i(a,
true,false)){b=doc.createElement(objectTag);n(a,b,"src");m(a,b,"onerror","onerrorcandidate")}else return false;c=a.getAttribute("src")}else if(isInternetExplorer&&y(a)){if(i(a,true,false)){b=doc.createElement(objectTag);n(a,b,"src");m(a,b,"onerror","onerrorcandidate")}else return false;c=a.getAttribute("src")}else if(null!=(c=o(a,false,true))){b=doc.createElement(objectTag);n(c,b,"src");m(c,b,"onerror","onerrorcandidate");c=c.getAttribute("src")}else if(null!=(c=o(a,true,true))){b=doc.createElement(objectTag);
n(c,b,"src");m(c,b,"onerror","onerrorcandidate");c=c.getAttribute("src")}else if(null!=(c=o(a,true,false))){b=doc.createElement(objectTag);n(c,b,"src");m(c,b,"onerror","onerrorcandidate");c=c.getAttribute("src")}else if(i(a,true,false)){b=doc.createElement(objectTag);n(a,b,"src");m(a,b,"onerror","onerrorcandidate");c=a.getAttribute("src")}else return false;if(c==null)return false;if(p(c,doc.location.href)!=true)return false;w(a,b);x(a,b);m(a,b,"poster","previewImage");c=getCSS(a,"width");var d=getCSS(a,
"height"),f=getCSS(a,"min-width"),s=getCSS(a,"min-height");if(c<f)c=f;if(d<s)d=s;0!=c?b.setAttribute("width",c):r(a,b,"width");0!=d?b.setAttribute("height",d):r(a,b,"height");null==a.getAttribute("controls")&&q(b,"mode","null");null!=a.getAttribute("autoplay")?q(b,"autoplay","true"):q(b,"autoplay","false");null!=a.getAttribute("loop")?q(b,"loop","true"):q(b,"loop","false");c=a.parentNode;if(isInternetExplorer&&!y(a))for(;;){d=a.nextSibling;if(null==d)break;if(null==d.tagName)break;f=d.tagName.toLowerCase();
c.removeChild(d);if("/video"==f)break}if(!isInternetExplorer){b.setAttribute("pluginspage","http://go.divx.com/plugin/download/");b.setAttribute("type","video/divx")}c.replaceChild(b,a);if(isInternetExplorer){b.setAttribute("codebase","http://go.divx.com/plugin/DivXBrowserPlugin.cab");b.setAttribute("classid","clsid:67DABFBF-D0AB-41fa-9C46-CC0F21721616")}a.removeAttribute("src");if(isGoogleChrome||isAppleSafari){a.onerror=function(){};a=a.childNodes;for(b=0;b<a.length;++b)if(null!=a[b]&&null!=a[b].tagName&&
"source"==a[b].tagName.toLowerCase())a[b].onerror=function(){}}return true}function i(a,b,c){if(ElementHasAttribute(a,"type")){a=a.getAttribute("type");return A(a,b,c)}else if(ElementHasAttribute(a,"src")){a:{a=a.getAttribute("src");b=["divx","div","avi","mkv","mp4","mov","qt","m4v","f4v"];c=false;var d=getBrowserVersion();if(isInternetExplorer&&d>=9)c=true;if(isAppleSafari&&d>=5)c=true;d=a.lastIndexOf("/");var f=a.lastIndexOf("\\");d=Math.max(d,f);d=-1!=d?a.substr(d+1,a.length):"";f=d.lastIndexOf(".");
a=(-1!=f?d.substr(f+1,a.length):"").toLowerCase();for(d=0;d<b.length;++d)if(a==b[d]){if(c&&d>=4)break;b=true;break a}b=false}return b}return false}function o(a,b,c){var d=null;if(isInternetExplorer)for(a=a.nextSibling;;){if(null==a)break;var f=a.tagName.toLowerCase();if("/video"==f)break;if("source"==f)if(i(a,b,c)){d=a;break}a=a.nextSibling}else{a=a.childNodes;for(f=0;f<a.length;++f)if(null!=a[f]&&null!=a[f].tagName&&"source"==a[f].tagName.toLowerCase())if(i(a[f],b,c)){d=a[f];break}}return d}function w(a,
b){for(var c=["class","contenteditable","contextmenu","dir","draggable","id","hidden","lang","style","spellcheck","tabindex","title","onblur","onchange","onclick","oncontextmenu","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","onfocus","onkeydown","onkeypress","onkeyup","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onmousewheel","onscroll","onselect","onsubmit"],d=0;d<c.length;++d)r(a,b,c[d])}function x(a,b){for(var c=["onloadstart",
"onprogress","onsuspend","onload","onabort","onerror","onloadend","onemptied","onstalled","onplay","onpause","onloadedmetadata","onloadeddata","onwaiting","onplaying","oncanplay","oncanplaythrough","onseeking","onseeked","ontimeupdate","onended","onratechange","ondurationchange","onvolumechange"],d=0;d<c.length;++d)n(a,b,c[d])}function r(a,b,c){a=a.getAttribute(c);null!=a&&b.setAttribute(c,a)}function q(a,b,c){if(isInternetExplorer){var d=doc.createElement("param");if(null!=d){d.setAttribute("name",
b);d.setAttribute("value",c);a.appendChild(d)}}else a.setAttribute(b,c)}function m(a,b,c,d){a=a.getAttribute(c);null!=a&&q(b,d,a)}function n(a,b,c){m(a,b,c,c)}function y(a){a=a.outerHTML;return a.length-2==a.lastIndexOf("/>")}function A(a,b,c){var d=["video/divx","video/avi","video/msvideo","video/x-msvideo","video/vnd.avi","video/x-matroska","video/mp4","video/quicktime","video/x-quicktime","video/m4v","video/x-m4v"],f=["avc1","avc1.42e00a","avc1.42e00b","avc1.42e00c","avc1.42e00d","avc1.42e014",
"avc1.42e015","avc1.42e016","avc1.42e01e","avc1.42e01f","avc1.42e020","avc1.42e028","avc1.4d400a","avc1.4d400b","avc1.4d400c","avc1.4d400d","avc1.4d4014","avc1.4d4015","avc1.4d4016","avc1.4d401e","avc1.4d401f","avc1.4d4020","avc1.4d4028","avc1.64000a","avc1.64000b","avc1.64000c","avc1.64000d","avc1.640014","avc1.640015","avc1.640016","avc1.64001e","avc1.64001f","avc1.640020","avc1.640028","mp4v.20.9","mp4v.20.240"],s=["mp4a","mp4a.40.2"],g="",t="",u="";a=a=a.toLowerCase();g=["\t","\n","\r","\u0008",
"\u000c"," ",String.fromCharCode(11),String.fromCharCode(160),String.fromCharCode(5760),String.fromCharCode(6158),String.fromCharCode(8194),String.fromCharCode(8195),String.fromCharCode(8196),String.fromCharCode(8197),String.fromCharCode(8198),String.fromCharCode(8199),String.fromCharCode(8200),String.fromCharCode(8201),String.fromCharCode(8202),String.fromCharCode(8203),String.fromCharCode(8204),String.fromCharCode(8205),String.fromCharCode(8239),String.fromCharCode(8194),String.fromCharCode(8287),
String.fromCharCode(8288),String.fromCharCode(12288),String.fromCharCode(65279)];for(var e=0;e<g.length;++e)a=a.split(g[e]).join("");a=a;e=a.indexOf(";");if(-1!=e){g=a.substr(e+1,a.length);a=a.substr(0,e);e=g.indexOf("codecs=");if(-1!=e){g=g.substr(8,g.length-7-2);e=g.indexOf(",");if(-1!=e){t=g.substr(0,e);u=g.substr(e+1,g.length)}else t=g}}g=false;e=getBrowserVersion();if(isInternetExplorer&&e>=9)g=true;if(isAppleSafari&&e>=5)g=true;e=false;for(var k=0;k<d.length;++k)if(a==d[k]){if(g&&k>=6)break;
e=true;break}if(!e)return false;if(""!=t){e=false;for(k=0;k<f.length;++k)if(t==f[k]){e=true;break}if(!e)return false;if(""!=u&&c){e=false;for(k=0;k<s.length;++k)if(u==s[k]){e=true;break}if(!e)return false}}else if(!b)return false;return true}if(isMozillaFirefox||isGoogleChrome||isAppleSafari){doc.addEventListener("DOMNodeInserted",j,false);doc.addEventListener("DOMNodeInsertedIntoDocument",h,false)}if(isInternetExplorer)if(getBrowserVersion()>=9){doc.addEventListener("DOMNodeInserted",j,false);doc.addEventListener("DOMNodeInsertedIntoDocument",
h,false)}else{var B=doc.body.appendChild;doc.body.appendChild=function(a){B(a);null!=a.tagName&&"video"==a.tagName.toLowerCase()&&l(a)};var C=doc.body.replaceChild;doc.body.replaceChild=function(a,b){C(a,b);null!=a.tagName&&"video"==a.tagName.toLowerCase()&&l(a)};var D=doc.body.insertBefore;doc.body.insertBefore=function(a,b){D(a,b);null!=a.tagName&&"video"==a.tagName.toLowerCase()&&l(a)}}for(var v=0;;){var z=doc.getElementsByTagName("video");if(v==z.length)break;l(z[v])||++v}};
